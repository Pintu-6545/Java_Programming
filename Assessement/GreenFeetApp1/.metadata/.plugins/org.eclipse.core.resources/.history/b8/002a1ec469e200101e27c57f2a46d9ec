package com.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;

import com.bean.Drivers;
import com.bean.Vehicles;
import com.util.GreenFleetUtil;

public class VehiclesDao {

	public static void insertVehicle(Vehicles v) {
	    try {
	        Connection conn = GreenFleetUtil.createConnection();
	        String sql = "INSERT INTO vehicle (driver_id, number_plate, type, insurance_expiry) VALUES (?,?,?,?)";
	        PreparedStatement ps = conn.prepareStatement(sql);

	        ps.setInt(1, v.getDriver_id());
	        ps.setString(2, v.getNumber_plate());
	        ps.setString(3, v.getType());
	        ps.setString(4, v.getInsurance_expiry());

	        ps.executeUpdate();
	    } catch (Exception e) {
	        e.printStackTrace();
	    }
	}
	
	public static Drivers getDriverById(int driver_id) {
	    Drivers d = null;

	    try {
	        Connection conn = GreenFleetUtil.createConnection();
	        String sql = "SELECT * FROM driver WHERE driver_id=?";
	        PreparedStatement ps = conn.prepareStatement(sql);
	        ps.setInt(1, driver_id);

	        ResultSet rs = ps.executeQuery();

	        if (rs.next()) {
	            d = new Drivers();
	            d.setDriver_id(rs.getInt("driver_id"));
	            d.setName(rs.getString("name"));
	        }

	    } catch (Exception e) {
	        e.printStackTrace();
	    }
	    return d;
	}


   }
